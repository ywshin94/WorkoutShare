<!DOCTYPE html>
<html>
<head>
    <title>Strava Callback</title>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        console.log("Received code:", code);
        if (code) {
            const redirectUrl = `workoutshare://oauth?code=${code}`;
            console.log("Redirecting to:", redirectUrl);
            
            // 리다이렉트 시도
            window.location.href = redirectUrl;
            
            // 리다이렉트가 실패할 경우를 대비해 2초 후 메시지 표시
            setTimeout(() => {
                document.body.innerHTML = `
                    <p>Failed to redirect to app.</p>
                    <p>Please return to the WorkoutShare app manually.</p>
                    <p>If the app does not open, try this link: <a href="${redirectUrl}">Open WorkoutShare</a></p>
                `;
            }, 2000);
        } else {
            console.log("No code found in URL parameters");
            document.body.innerHTML = "<p>Error: No authorization code found.</p>";
        }
    </script>
</head>
<body>
    <p>Redirecting to app...</p>
</body>
</html>